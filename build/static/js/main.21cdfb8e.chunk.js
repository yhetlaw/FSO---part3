(this.webpackJsonpphonebook=this.webpackJsonpphonebook||[]).push([[0],{38:function(e,t,n){},39:function(e,t,n){"use strict";n.r(t);var c=n(14),r=n.n(c),s=n(3),a=n(1),o=n(0),u=function(e){var t=e.persons;return Object(o.jsxs)("div",{children:["Search name: ",Object(o.jsx)("input",{onChange:function(e){var n=e.target.value,c=t.map((function(e){return e.name.toUpperCase()})),r=document.getElementById("pExists");c.includes(n.toUpperCase())?r.innerHTML="The name ".concat(n," exists"):r.innerHTML="The name ".concat(n," does not exist")}}),Object(o.jsx)("p",{id:"pExists"})]})},i=n(4),l=n.n(i),d="/api/persons",b=function(){return l.a.get(d).then((function(e){return e.data}))},j=function(e){return l.a.post(d,e).then((function(e){return e.data}))},h=function(e,t){return l.a.put("".concat(d,"/").concat(e),t).then((function(e){return e.data}))},m=function(e){return l.a.delete("".concat(d,"/").concat(e)).then((function(e){return e.data}))},f=function(e){var t=e.onNameChange,n=e.onNumberChange,c=e.persons,r=e.newName,s=e.newNumber,a=e.setNewName,u=e.setNewNumber,i=e.setPersons,l=e.setLength,d=e.length,b=e.setAlertMessage,m=e.setErrorMessage;return Object(o.jsx)("div",{children:Object(o.jsxs)("form",{onSubmit:function(e){e.preventDefault();var t={name:r,number:Number(s)},n=c.map((function(e){return e.name.toUpperCase()})),o=c.map((function(e){return e.number}));if(n.includes(r.toUpperCase())){if(window.confirm("The name ".concat(r," is already added to the phonebook, replace old number with the new one?")))if(-1!==o.indexOf(+s))alert("Number ".concat(s," is taken")),document.getElementById("newNumber-input").value="";else{var f=c.filter((function(e){return e.name===r}))[0].id;h(f,t).then((function(e){i(Object.assign(c,t)),b("Contact ".concat(r," has been updated!")),setTimeout((function(){b(null)}),3e3),a(""),u(""),l(d+1),l(d-1)})).catch((function(e){m("Contact ".concat(r," has not been updated.")),setTimeout((function(){b(null)}),3e3)}))}}else-1!==o.indexOf(+s)?(alert("Number ".concat(s," is taken")),document.getElementById("newNumber-input").value=""):j(t).then((function(e){i(c.concat(e)),b("Contact ".concat(r," has been added!")),setTimeout((function(){b(null)}),3e3),a(""),u("")})).catch((function(e){m(e.response.data.error)}))},children:[Object(o.jsxs)("div",{children:["name: ",Object(o.jsx)("input",{value:r,onChange:t})]}),Object(o.jsxs)("div",{children:["number: ",Object(o.jsx)("input",{value:s,onChange:n,id:"newNumber-input"})]}),Object(o.jsx)("div",{children:Object(o.jsx)("button",{type:"submit",children:"add"})})]})})},p=function(e){var t=e.handleButtonDelete,n=e.text,c=e.id,r=e.number;return Object(o.jsxs)("li",{children:[n," ",r," ",Object(o.jsx)("button",{"data-id":c,onClick:t,children:"Delete"})]})},O=function(e){var t=e.persons,n=e.setPersons,c=e.setLength,r=function(e){var r=e.target.getAttribute("data-id");console.log(r),window.confirm("Are you sure you want to delete?")&&m(r).then((function(e){n(t.filter((function(e){return e.id!==r}))),console.log("Deleted successfully"),c(t.length)})).catch((function(e){console.log("fail")}))};return Object(o.jsx)("div",{children:Object(o.jsx)("ul",{children:t.map((function(e){return Object(o.jsx)(p,{id:e.id,text:e.name,number:e.number,handleButtonDelete:r},e.id)}))})})},g=function(e){var t=e.message;return null===t?null:Object(o.jsx)("div",{className:"alert",children:t})},x=function(e){var t=e.message;return null===t?null:Object(o.jsx)("div",{className:"error",children:t})},v=function(){var e=Object(a.useState)([]),t=Object(s.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(""),i=Object(s.a)(r,2),l=i[0],d=i[1],j=Object(a.useState)(""),h=Object(s.a)(j,2),m=h[0],p=h[1],v=Object(a.useState)([]),N=Object(s.a)(v,2),w=N[0],C=N[1],k=Object(a.useState)(null),y=Object(s.a)(k,2),E=y[0],S=y[1],T=Object(a.useState)(null),B=Object(s.a)(T,2),L=B[0],M=B[1];return Object(a.useEffect)((function(){b().then((function(e){console.log("promise fulfilled"),c(e)}))}),[w]),console.log("render",n.length,"persons"),Object(o.jsxs)("div",{children:[Object(o.jsx)("h1",{children:"Phonebook"}),Object(o.jsx)(u,{persons:n}),Object(o.jsx)("h1",{children:"Add a new contact"}),Object(o.jsx)(f,{onNameChange:function(e){return d(e.target.value)},onNumberChange:function(e){return p(e.target.value)},persons:n,newName:l,newNumber:m,setNewName:d,setNewNumber:p,setPersons:c,setLength:C,length:w,setAlertMessage:S,setErrorMessage:M}),Object(o.jsx)("h1",{children:"Contacts"}),Object(o.jsx)(g,{message:E}),Object(o.jsx)(x,{message:L}),Object(o.jsx)(O,{persons:n,setPersons:c,setLength:C})]})};n(38);r.a.render(Object(o.jsx)(v,{}),document.getElementById("root"))}},[[39,1,2]]]);
//# sourceMappingURL=main.21cdfb8e.chunk.js.map